<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="icon.png" type="image/x-icon">
    <link rel="shortcut icon" href="icon.png" type="image/x-icon">

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5483486229407301" crossorigin="anonymous"></script>
    
    <title>RGBing(ì•Œì§€ë¹™)</title>
</head>
<body>
    <div class="option-box">
        <button id="music-toggle" class="music-button">ğŸ”•</button>
        <audio id="background-music" src="Strollin' - TrackTribe.mp3" loop></audio>
        <button id="home-toggle" class="music-button" onclick="goHome()">ğŸ </button>
        <button id="share-toggle" class="music-button" onclick="shareContent()">ğŸ’Œ</button>
        <button id="clear-toggle" class="clear-button" onclick="showClear()">ğŸ†</button>
    </div>

    <div class="top-box">
        <h1>ìƒ‰ ë§ì¶”ê¸° ê²Œì„</h1>
        <p id="top-1" class="top-1"><b>0ë²ˆì§¸ ì˜¤ëŠ˜ì˜ ìƒ‰ì„ ë§ì¶°ë³´ì„¸ìš”!</b></p>
    </div>

    <div class="game-box">
        <div class="color-container">
            <div>
                <h3>ì˜¤ëŠ˜ì˜ ìƒ‰</h3>
                <div class="color-box" id="colorBox"></div>
            </div>
            <div>
                <h3>ì…ë ¥í•œ ìƒ‰</h3>
                <div class="preview-box" id="previewBox"></div>
            </div>
        </div>
    
        <!-- R ìƒ‰ìƒ ì…ë ¥ -->
        <div class="input-group">
            <!-- <label for="red">R: </label> -->
            <div class="slider-container">
                <button onclick="adjustColor('red', -1)" class="red-button">-</button>
                <input type="range" id="redSlider" min="0" max="255" value="0" oninput="updateInput('red')">
                <button onclick="adjustColor('red', 1)" class="red-button">+</button>
            </div>
            <input type="number" id="red" min="0" max="255" value="0" oninput="updateSlider('red')">
        </div>

        <!-- G ìƒ‰ìƒ ì…ë ¥ -->
        <div class="input-group">
            <!-- <label for="green">G: </label> -->
            <div class="slider-container">
                <button onclick="adjustColor('green', -1)" class="green-button">-</button>
                <input type="range" id="greenSlider" min="0" max="255" value="0" oninput="updateInput('green')">
                <button onclick="adjustColor('green', 1)" class="green-button">+</button>
            </div>
            <input type="number" id="green" min="0" max="255" value="0" oninput="updateSlider('green')">
        </div>

        <!-- B ìƒ‰ìƒ ì…ë ¥ -->
        <div class="input-group">
            <!-- <label for="blue">B: </label> -->
            <div class="slider-container">
                <button onclick="adjustColor('blue', -1)" class="blue-button">-</button>
                <input type="range" id="blueSlider" min="0" max="255" value="0" oninput="updateInput('blue')">
                <button onclick="adjustColor('blue', 1)" class="blue-button">+</button>
            </div>
            <input type="number" id="blue" min="0" max="255" value="0" oninput="updateSlider('blue')">
        </div>

        <div class="button-box">
            <button class="give-up-button" onclick="giveUp()">í¬ê¸°í•˜ê¸°</button>
            <button class="hint-button" onclick="showHint()">íŒíŠ¸</button>
            <button class="check-button" onclick="checkGuess()">ì œì¶œí•˜ê¸°</button>
        </div>

        <div class="result" id="result"></div>

        <button class="collectBtn" id="collectBtn" onclick="collectBtn()">ì»¬ë ‰ì…˜ ì¶”ê°€</button>
        
    </div>

    <div id="qna-box" class="qna-box">
        <p class="qna-title">Q&A</p>
        <div class="color-div-2"></div>
        <p class="qna-1">1. ìƒ‰ ë§ì¶”ê¸° ê²Œì„ì€ ë¬´ì—‡ì¸ê°€ìš”?</p>
        <p class="qna-2">ìƒ‰ ë§ì¶”ê¸° ê²Œì„ì€ <span class="qna-line">í•˜ë£¨ì— í•œ ë²ˆ</span> ì •í•´ì§€ëŠ” ì˜¤ëŠ˜ì˜ ìƒ‰ì„ ë§íˆëŠ” ê²Œì„ì…ë‹ˆë‹¤. R, G, B ê°ê°ì˜ ìˆ˜ì¹˜ë¥¼ ì¡°ì ˆí•˜ê³  ì •ë‹µì„ ì œì¶œí•˜ë©´, ì˜¤ëŠ˜ì˜ ìƒ‰ìƒê³¼ ì–¼ë§ˆë‚˜ ìœ ì‚¬í•œì§€ ìœ ì‚¬ë„ë¥¼ ë°±ë¶„ìœ¨ë¡œ ì•Œë ¤ì¤ë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ë“¤ì˜ ìƒ‰ê° ì„¼ìŠ¤ë¥¼ í™œìš©í•´ì„œ ì •ë‹µì„ ë§ì¶°ë³´ì„¸ìš”.</p>
        <p class="qna-1">2. RGBë€ ë¬´ì—‡ì¸ê°€ìš”?</p>
        <p class="qna-2">Red(ë¹¨ê°„ìƒ‰), Green(ë…¹ìƒ‰), Blue(íŒŒë€ìƒ‰) ì„¸ ê°€ì§€ ìƒ‰ìƒ ì±„ë„ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ì–‘í•œ ìƒ‰ì„ í‘œí˜„í•˜ëŠ” ìƒ‰ìƒ ëª¨ë¸ì…ë‹ˆë‹¤. RGBëŠ” ê° ìƒ‰ìƒ ì±„ë„ì˜ ê°•ë„ë¥¼ ì¡°ì ˆí•˜ì—¬ ì›í•˜ëŠ” ìƒ‰ì„ ë§Œë“¤ ìˆ˜ ìˆìœ¼ë©°, ê° ì±„ë„ì˜ ê°’ì€ ì¼ë°˜ì ìœ¼ë¡œ 0ì—ì„œ 255 ì‚¬ì´ì˜ ìˆ«ìë¡œ í‘œí˜„ë©ë‹ˆë‹¤.</p>
        <p class="qna-1">3. ìœ ì‚¬ë„ë€ ë¬´ì—‡ì¸ê°€ìš”?</p>
        <p class="qna-2">ì˜¤ëŠ˜ì˜ ìƒ‰ì— ëŒ€í•œ ê°’ì„ ë°”íƒ•ìœ¼ë¡œ ì œì¶œí•œ ìƒ‰ì˜ ìˆ˜ì¹˜ê°€ ì–¼ë§ˆë‚˜ ìœ ì‚¬í•œì§€ì˜ ì •ë„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ì…ë‹ˆë‹¤. 100%ì— ê°€ê¹Œì›Œì§ˆ ìˆ˜ë¡ ì •ë‹µì— ê°€ê¹Œì›Œì§€ê³  ìˆë‹¤ê³  ì´í•´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        <p class="qna-1">4. íŒíŠ¸ëŠ” ì–´ë–»ê²Œ ì‚¬ìš©í•˜ë‚˜ìš”?</p>
        <p class="qna-2">íŒíŠ¸ì—ì„œëŠ” RGB ê°ê°ì˜ ìˆ˜ì¹˜ì— ëŒ€í•œ ìœ ì‚¬ë„ë¥¼ ë³´ì—¬ì£¼ë©°, íŒíŠ¸ì—ì„œ 100%ì˜ ìˆ˜ì¹˜ëŠ” ì •ë‹µì´ê±°ë‚˜ ë§¤ìš° ê·¼ì ‘í•œ ê°’ì´ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤. íŒíŠ¸ ê¸°íšŒëŠ” <span class="qna-line">í•˜ë£¨ì— 10ë²ˆë§Œ</span> ì£¼ì–´ì§€ë‹ˆ ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©í•˜ì„¸ìš”!</p>
        <p class="qna-1">5. HEX ê°’ì´ë€ ë¬´ì—‡ì¸ê°€ìš”?</p>
        <p class="qna-2">RGB ìƒ‰ìƒì„ 16ì§„ìˆ˜ë¡œ ë‚˜íƒ€ë‚´ëŠ” ë°©ì‹ìœ¼ë¡œ, ì£¼ë¡œ ì›¹ ë””ìì¸ì—ì„œ ë§ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. #RRGGBB í˜•ì‹ìœ¼ë¡œ í‘œí˜„ë˜ë©°, ê°ê° ë‘ ìë¦¬ì˜ 16ì§„ìˆ˜ë¡œ ë¹¨ê°•(RR), ì´ˆë¡(GG), íŒŒë‘(BB)ì˜ ê°•ë„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</p>
        <p class="qna-1">6. ë¸Œê¸ˆì— ëŒ€í•œ ì •ë³´ë¥¼ ì•Œê³  ì‹¶ì–´ìš”.</p>
        <p class="qna-2">ìœ íŠœë¸Œ ì˜¤ë””ì˜¤ ë³´ê´€í•¨ì— ìˆëŠ” TrackTribeì´ë¼ëŠ” ì•„í‹°ìŠ¤íŠ¸ì˜ Strollin' ìŒì•…ì„ ì‚¬ìš©í•˜ê³  ìˆì–´ìš”.</p>
    </div>

    <script>
        const musicToggleBtn = document.getElementById("music-toggle");
        const backgroundMusic = document.getElementById("background-music");

        musicToggleBtn.addEventListener("click", () => {
            if (backgroundMusic.paused) {
                backgroundMusic.play();
                musicToggleBtn.textContent = "ğŸ””";
                localStorage.setItem("audioStatus", "on");
            } else {
                backgroundMusic.pause();
                musicToggleBtn.textContent = "ğŸ”•";
                localStorage.setItem("audioStatus", "off");
            }
        });

        const today = new Date().toLocaleDateString("ko-KR", {
            year: "numeric",
            month: "2-digit",
            day: "2-digit",
            timeZone: "Asia/Seoul"
        }).replace(/\./g, "/").replace(/\s/g, "").replace(/\/$/, "");
        const savedate = today;

        let redValue, greenValue, blueValue, clearcount, colorName;
        let submitCount, hintCount, colorCount;

        // ë‚ ì§œê°€ ë°”ë€Œë©´ íŒíŠ¸ ì‚¬ìš© íšŸìˆ˜ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤
        if (localStorage.getItem('todaydate') != today) {
            localStorage.setItem("submitCount", 0);
            localStorage.setItem("hintData", 10);
            localStorage.setItem('clear', 'false');
            localStorage.setItem('gaveUp', 'false');
            localStorage.setItem('user_r', 0);
            localStorage.setItem('user_g', 0);
            localStorage.setItem('user_b', 0);
            localStorage.setItem('collect', 'false');

            localStorage.setItem('todaydate', savedate);
        }

        console.log('today date:' + localStorage.getItem('todaydate'));
        console.log('submitCount:' + localStorage.getItem('submitCount'));
        console.log('hintData:' + localStorage.getItem('hintData'));
        console.log('clear:' + localStorage.getItem('clear'));
        console.log('gaveUp:' + localStorage.getItem('gaveUp'));

        // Firebase ì´ˆê¸°í™”
        const firebaseConfig = {
            apiKey: "AIzaSyCyyqlzjApUgvJyysZKJIfY4lVz-lWmyEM",
            authDomain: "rgbing-3a593.firebaseapp.com",
            projectId: "rgbing-3a593",
            storageBucket: "rgbing-3a593.firebasestorage.app",
            messagingSenderId: "503895940241",
            appId: "1:503895940241:web:5e42593e93572563ac3330",
            measurementId: "G-RTREG5QN0D"
        };

        // Firebase ì•± ì´ˆê¸°í™”
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // ì´ˆê¸°í™” ì‹œ Firebaseì—ì„œ ìƒ‰ìƒ ê°€ì ¸ì˜¤ê¸°
        window.onload = () => {
            const colorBox = document.getElementById("colorBox");
            colorBox.style.backgroundColor = `rgb(${redValue}, ${greenValue}, ${blueValue})`; // ê¸°ë³¸ ìƒ‰ìƒ ì„¤ì •
            loadData();
        };

        function loadData() {
            // ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ì°¸ì¡°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const colorDataRef = database.ref('/color_data/' + today);
            colorDataRef.once('value', (snapshot) => {
                // ë°ì´í„°ë¥¼ JSON ê°ì²´ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.
                const colorData = snapshot.val();

                // ì›í•˜ëŠ” ê°’ì„ ì¶”ì¶œí•©ë‹ˆë‹¤.
                redValue = colorData.red;
                blueValue = colorData.blue;
                greenValue = colorData.green;
                colorName = colorData.name;

                colorCount = colorData.cnt;
                setColorOfTheDay();

                // ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
                console.log('Today:', today);
                console.log('Red:', redValue);
                console.log('Blue:', blueValue);
                console.log('Green:', greenValue);
            });

            const clearDataRef = database.ref('/clear_user/' + today);
            clearDataRef.once('value', (snapshot) => {
                // ë°ì´í„°ë¥¼ JSON ê°ì²´ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.
                const clearData = snapshot.val();

                // ì›í•˜ëŠ” ê°’ì„ ì¶”ì¶œí•©ë‹ˆë‹¤.
                clearcount = clearData;
                setColorOfTheDay();

                console.log('Clear User:', clearcount);
            });
            /*
            const viewRef = database.ref('/view/' + today);
            // ì½œë°± í•¨ìˆ˜ì—ì„œ ë°ì´í„°ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŒì„ í™•ì¸í•©ë‹ˆë‹¤.
            viewRef.transaction(function(currentData) {
                return currentData + 1;
            }, function(error, committed, snapshot) {
            if (error) {
                console.log('Transaction failed: ' + error);
            } else if (committed) {
                console.log('Transaction committed successfully.');
            }
            });*/
        }

        // Firebaseì—ì„œ ê°€ì ¸ì˜¨ ìƒ‰ìƒìœ¼ë¡œ ì—…ë°ì´íŠ¸
        function setColorOfTheDay() {
            const colorBox = document.getElementById("colorBox");
            colorBox.style.backgroundColor = `rgb(${redValue}, ${greenValue}, ${blueValue})`; 

            // CSS ë³€ìˆ˜ë¡œ ì ìš©
            document.documentElement.style.setProperty('--random-color', `RGB(${redValue}, ${greenValue}, ${blueValue})`);

            document.getElementById("top-1").innerHTML = `<b>${colorCount}ë²ˆì§¸ ì˜¤ëŠ˜ì˜ ìƒ‰ì„ ë§ì¶°ë³´ì„¸ìš”!</b>`;
            document.getElementById("clear-toggle").textContent = `ğŸ† ${clearcount}`;

            // í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ localStorageì—ì„œ í¬ê¸° ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
            const gaveUp = localStorage.getItem('gaveUp');
            if (gaveUp == 'true') {
                showAnswer();
            }

            const clear = localStorage.getItem('clear');
            if (clear == 'true') {
                showAnswer();
            }
        }

        // ì„±ê³µ íšŸìˆ˜ ë²„íŠ¼ í´ë¦­ ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜
        function showClear() {
            alert(`${today}\nì˜¤ëŠ˜ì˜ ìƒ‰ì„ ë§ì¶˜ ì‚¬ëŒë“¤ì€ í˜„ì¬ê¹Œì§€ ${clearcount}ëª… ì…ë‹ˆë‹¤.`);
        }

        function goHome() {
            window.location.href = 'index.html';
        }

        function shareContent() {
            if (navigator.share) {
                navigator.share({
                    title: 'ğŸ¨RGBing - ìƒ‰ ë§ì¶”ê¸° ê²Œì„ğŸ¨',
                    text: 'ì—¬ëŸ¬ë¶„ë“¤ì˜ ìƒ‰ê° ì„¼ìŠ¤ë¥¼ í™œìš©í•´ì„œ ì˜¤ëŠ˜ì˜ ìƒ‰ì„ ë§ì¶°ë³´ì„¸ìš”.',
                    url: window.location.href
                })
                .then(() => console.log('ê³µìœ  ì„±ê³µ'))
                .catch((error) => console.log('ê³µìœ  ì‹¤íŒ¨', error));
            } else {
                alert("ê³µìœ  ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.");
            }
        }

        // ìŠ¬ë¼ì´ë” ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateSlider(color) {
            const value = document.getElementById(color).value;
            document.getElementById(color + "Slider").value = value;
            updatePreview();
        }

        // ì…ë ¥ í•„ë“œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateInput(color) {
            const value = document.getElementById(color + "Slider").value;
            document.getElementById(color).value = value;
            updatePreview();
        }

        // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        function updatePreview() {
            const r = document.getElementById("red").value || 0;
            const g = document.getElementById("green").value || 0;
            const b = document.getElementById("blue").value || 0;

            const previewBox = document.getElementById("previewBox");
            previewBox.style.backgroundColor = `RGB(${r}, ${g}, ${b})`;
        }

        // ìƒ‰ìƒ ì¡°ì • ë²„íŠ¼ í•¨ìˆ˜
        function adjustColor(color, change) {
            const input = document.getElementById(color);
            let newValue = parseInt(input.value) + change;

            // ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ì§€ ì•Šë„ë¡ ì„¤ì •
            if (newValue < 0) {
                newValue = 0;
            } else if (newValue > 255) {
                newValue = 255;
            }

            input.value = newValue; // ìˆ˜ì¹˜ ì—…ë°ì´íŠ¸
            updateSlider(color); // ìŠ¬ë¼ì´ë”ì™€ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        }

        // ìœ ì‚¬ë„ ê³„ì‚° í•¨ìˆ˜
        function calculateSimilarity(inputColor) {
            const rDiff = Math.abs(inputColor.r - redValue);
            const gDiff = Math.abs(inputColor.g - greenValue);
            const bDiff = Math.abs(inputColor.b - blueValue);

            const maxDifference = 255 * 3;
            const totalDifference = rDiff + gDiff + bDiff;

            // ìœ ì‚¬ë„ë¥¼ 0ì—ì„œ 100%ë¡œ ë³€í™˜
            return Math.round((1 - totalDifference / maxDifference) * 100);
        }

        // ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ê³¼ ë¹„êµ
        function checkGuess() {
            const r = parseInt(document.getElementById("red").value);
            const g = parseInt(document.getElementById("green").value);
            const b = parseInt(document.getElementById("blue").value);

            localStorage.setItem("user_r", r);
            localStorage.setItem("user_g", g);
            localStorage.setItem("user_b", b);

            const inputColor = { r, g, b };
            const similarity = calculateSimilarity(inputColor);
            submitData = localStorage.getItem('submitCount');
            hintData = localStorage.getItem('hintData');
            submitData++; // ì œì¶œ íšŸìˆ˜ ì¦ê°€
            localStorage.setItem("submitCount", submitData);

            // ì •ë‹µê³¼ ë¹„êµí•˜ì—¬ ë©”ì‹œì§€ ì¶œë ¥
            if (r === redValue && g === greenValue && b === blueValue) {
                localStorage.setItem('clear', 'true');

                const clearRef = database.ref('/clear_user/' + today);
                // ì½œë°± í•¨ìˆ˜ì—ì„œ ë°ì´í„°ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŒì„ í™•ì¸í•©ë‹ˆë‹¤.
                clearRef.transaction(function(currentData) {
                    return currentData + 1;
                }, function(error, committed, snapshot) {
                if (error) {
                    console.log('Transaction failed: ' + error);
                } else if (committed) {
                    console.log('Transaction committed successfully.');
                }
                });
                clearcount = clearcount + 1;
                showAnswer();
            } else if(similarity == 100) {
                document.getElementById("result").innerHTML = 
                    `RGB(${r}, ${g}, ${b}), ê±°ì˜ ë‹¤ ì™”ìŠµë‹ˆë‹¤!<br>ì œì¶œí•œ íšŸìˆ˜: ${submitData}ë²ˆ, ë‚¨ì€ íŒíŠ¸ íšŸìˆ˜: ${hintData}ë²ˆ`;
            }
            else {
                document.getElementById("result").innerHTML = 
                `RGB(${r}, ${g}, ${b}), ìœ ì‚¬ë„: ${similarity}% ì…ë‹ˆë‹¤.<br>ì œì¶œí•œ íšŸìˆ˜: ${submitData}ë²ˆ, ë‚¨ì€ íŒíŠ¸ íšŸìˆ˜: ${hintData}ë²ˆ`;
            }
        }

        // í¬ê¸°í•˜ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜
        function giveUp() {
            const confirmGiveUp = confirm("ì •ë‹µì„ í™•ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
            if (confirmGiveUp) {
                localStorage.setItem('gaveUp', 'true');
                showAnswer();             
            }
        }

        // ì •ë‹µì„ í‘œì‹œí•˜ê³  ë²„íŠ¼ê³¼ ìŠ¬ë¼ì´ë”ë¥¼ ë¹„í™œì„±í™”í•˜ëŠ” í•¨ìˆ˜
        function showAnswer() {
            submitData = localStorage.getItem('submitCount');
            hintData = localStorage.getItem('hintData');

            const slider_r = document.getElementById("redSlider");
            const slider_g = document.getElementById("greenSlider");
            const slider_b = document.getElementById("blueSlider");
            slider_r.value = localStorage.getItem('user_r');
            slider_g.value = localStorage.getItem('user_g');
            slider_b.value = localStorage.getItem('user_b');
            document.getElementById('red').value = localStorage.getItem('user_r');
            document.getElementById('green').value = localStorage.getItem('user_g');
            document.getElementById('blue').value = localStorage.getItem('user_b');
            const previewBox = document.getElementById("previewBox");
            previewBox.style.backgroundColor = `RGB(${localStorage.getItem('user_r')}, ${localStorage.getItem('user_g')}, ${localStorage.getItem('user_b')})`;


            if(localStorage.getItem('gaveUp') == 'true') {
                document.getElementById("result").innerHTML = 
                `í¬ê¸°í•˜ë‹¤ë‹ˆ ì•„ì‰½ë„¤ìš”.<br>ì •ë‹µ ìƒ‰ìƒ: RGB(${redValue}, ${greenValue}, ${blueValue}) ì…ë‹ˆë‹¤.<br>ì œì¶œí•œ íšŸìˆ˜: ${submitData}ë²ˆ, íŒíŠ¸ ì‚¬ìš© íšŸìˆ˜: ${10-hintData}ë²ˆ`;
            }
            
            if(localStorage.getItem('clear') == 'true') {
                document.getElementById("result").innerHTML = `RGB(${redValue}, ${greenValue}, ${blueValue})<br>ì •ë‹µì…ë‹ˆë‹¤! ${clearcount}ë²ˆì§¸ë¡œ ë§ì·„ìŠµë‹ˆë‹¤.<br>ì œì¶œí•œ íšŸìˆ˜: ${submitData}ë²ˆ, íŒíŠ¸ ì‚¬ìš© íšŸìˆ˜: ${10-hintData}ë²ˆ`;
            }

            // ì…ë ¥ í•„ë“œ ë¹„í™œì„±í™”
            document.getElementById("red").disabled = true;
            document.getElementById("green").disabled = true;
            document.getElementById("blue").disabled = true;
            document.getElementById("redSlider").disabled = true;
            document.getElementById("greenSlider").disabled = true;
            document.getElementById("blueSlider").disabled = true;

            const arrowButtons = document.querySelectorAll(".slider-container button");
            arrowButtons.forEach(button => button.disabled = true);

            document.querySelector(".give-up-button").disabled = true;
            document.querySelector(".hint-button").disabled = true;
            document.querySelector(".check-button").disabled = true;
        }

        function collectBtn() {
            const result = confirm("ì˜¤ëŠ˜ì˜ ìƒ‰ì„ ì»¬ë ‰ì…˜ì— ì¶”ê°€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
            if (result && localStorage.getItem('collect') == 'false') {
                if(localStorage.getItem('clear') == 'true') {
                    let userName = prompt("ì‚¬ìš©ì IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:");
                    if(userName != null) {
                        // ì‚¬ìš©ì IDê°€ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
                        const userRef = database.ref('users/' + userName);
                        userRef.once('value', function(snapshot) {
                            if (snapshot.exists()) {
                                let userPass = prompt("ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:");
                                const userRef2 = database.ref('users/' + userName + '/password');
                                userRef2.once('value', function(snapshot) {
                                    if (snapshot.val() == userPass) {
                                        addCollection(userName);
                                    } else {
                                        alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
                                    }
                                });
                            } else {
                                const noID = confirm("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ID ì…ë‹ˆë‹¤.\nìƒˆë¡œ ë“±ë¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?");
                                if (noID) {
                                    let userName2 = prompt("ì‚¬ìš©ì IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:");
                                    if(userName2 != null) {
                                    // ì‚¬ìš©ì IDê°€ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
                                    const userRef = database.ref('users/' + userName2);
                                    userRef.once('value', function(snapshot) {
                                        if (snapshot.exists()) {
                                            alert("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ID ì…ë‹ˆë‹¤.")
                                        } else {
                                            let userPass2 = prompt("ì‚¬ìš©ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:");
                                            addUser(userName2, userPass2);
                                        }
                                    });
                                }
                                else alert("ì˜¤ëŠ˜ì˜ ìƒ‰ ì €ì¥ì„ ì·¨ì†Œí•˜ì˜€ìŠµë‹ˆë‹¤.");
                                }
                                else {
                                    alert("ì˜¤ëŠ˜ì˜ ìƒ‰ ì €ì¥ì„ ì·¨ì†Œí•˜ì˜€ìŠµë‹ˆë‹¤.");
                                }
                            }
                        });
                    }
                    else alert("ì˜¤ëŠ˜ì˜ ìƒ‰ ì €ì¥ì„ ì·¨ì†Œí•˜ì˜€ìŠµë‹ˆë‹¤.");
                    }
                    else{
                        alert("ì•„ì§ ì˜¤ëŠ˜ì˜ ìƒ‰ì„ ë§íˆì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
                    }
            } else {
                if(localStorage.getItem('collect') == 'true') {
                    alert("ì´ë¯¸ ì¶”ê°€ëœ ìƒ‰ì…ë‹ˆë‹¤.");
                }
                else alert("ì˜¤ëŠ˜ì˜ ìƒ‰ ì €ì¥ì„ ì·¨ì†Œí•˜ì˜€ìŠµë‹ˆë‹¤.");
            }
            
        }

        function addUser(userName, userPass) {
            database.ref('users/' + userName).update({
              password: userPass
          });
          addCollection(userName);
        }

        function addCollection(userName) {
            database.ref('users/' + userName + '/' + today).update({
              red: redValue,
              green: greenValue,
              blue: blueValue,
              name: colorName
          })
          localStorage.setItem('collect', 'true');
          alert("ì˜¤ëŠ˜ì˜ ìƒ‰ì„ ì»¬ë ‰ì…˜ì— ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.");
        }

        // íŒíŠ¸ë¥¼ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜ ìˆ˜ì •
        function showHint() {
            const hintOutput = document.getElementById("hint-output");

            hintData = localStorage.getItem('hintData');

            // ë‚¨ì€ íŒíŠ¸ íšŸìˆ˜ê°€ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤
            if (hintData > 0) {
                // íŒíŠ¸ë¥¼ í‘œì‹œí•˜ê³  ë‚¨ì€ íŒíŠ¸ íšŸìˆ˜ë¥¼ ê°ì†Œì‹œí‚µë‹ˆë‹¤
                const r = parseInt(document.getElementById("red").value);
                const g = parseInt(document.getElementById("green").value);
                const b = parseInt(document.getElementById("blue").value);

                const rDiff = 255 - Math.abs(r - redValue);
                const gDiff = 255 - Math.abs(g - greenValue);
                const bDiff = 255 - Math.abs(b - blueValue);

                // ê°ê°ì˜ R, G, Bì— ëŒ€í•œ ìœ ì‚¬ë„ ê³„ì‚°
                alert(`R ìœ ì‚¬ë„: ${Math.round((rDiff / 255) * 100)}%\n` +
                    `G ìœ ì‚¬ë„: ${Math.round((gDiff / 255) * 100)}%\n` +
                    `B ìœ ì‚¬ë„: ${Math.round((bDiff / 255) * 100)}%\n` +
                    `(ë‚¨ì€ íŒíŠ¸ íšŸìˆ˜: ${hintData - 1}íšŒ)`);
                
                // ë‚¨ì€ íŒíŠ¸ íšŸìˆ˜ë¥¼ ì—…ë°ì´íŠ¸
                hintData--;
                localStorage.setItem("hintData", hintData);
            } else {
                alert(`ì˜¤ëŠ˜ì˜ íŒíŠ¸ ì‚¬ìš© íšŸìˆ˜ë¥¼ ëª¨ë‘ ì†Œì§„í–ˆìŠµë‹ˆë‹¤.\në‚´ì¼ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`);
            }
        }

        // RGB ê°’ì„ HEX ê°’ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
        function rgbToHex() {
            return "#" + ((1 << 24) + (redValue << 16) + (greenValue << 8) + blueValue).toString(16).slice(1).toUpperCase();
        }
    
    </script>

</body>
</html>
